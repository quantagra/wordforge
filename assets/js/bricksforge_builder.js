class BricksforgeBuilder{observer=null;bricksRoot=null;bricksState=null;bricksActiveElement=null;bricksActiveElementObject=null;bricksforgeRoot=null;bricksforgeState=null;bricksforgeStores=null;bricksforgeStoreAi=null;constructor(){this.init()}init(){this.createVueWrapper(),this.initVueInstances(),this.initMutationObservers()}createVueWrapper(){const e=document.createElement("div");e.id="bricksforge-builder";document.querySelector("#bricks-preview")&&document.querySelector("#bricks-preview").appendChild(e)}initVueInstances(){this.bricksRoot=document.querySelector(".brx-body").__vue_app__.config.globalProperties,this.bricksState=this.bricksRoot.$_state,setTimeout((()=>{this.bricksforgeRoot=document.querySelector("#bricksforge-builder").__vue_app__.config.globalProperties,this.bricksforgeState=this.bricksforgeRoot.$pinia.state,this.bricksforgeStores=this.bricksforgeState._value,this.bricksforgeStoreAi=this.bricksforgeStores.ai,console.log(this.bricksforgeStoreAi)}),1e3)}initMutationObservers(){this.observer=new MutationObserver((e=>{if(this.getActiveElement(),console.log(e),"brf-pro-forms"===this.bricksActiveElement)this.handleProForms()})),this.observer.observe(document.querySelector("#bricks-panel-inner"),{childList:!0,subtree:!0})}getActiveElement(e=!1){return this.bricksState.activeElement?e?(this.bricksActiveElementObject=this.bricksState.activeElement,this.bricksState.activeElement):(this.bricksActiveElement=this.bricksState.activeElement.name,this.bricksState.activeElement.name):null}handleProForms(){this.handleProFormsAi()}handleProFormsAi(){const e=document.querySelector(".bricks-panel-controls");if(e&&!e.querySelector(".bricksforge-button-ai")){const t=this.createButton("Bricksforge Assistant","block",{marginBottom:"-10px"},null,(()=>{console.log(this.bricksforgeStoreAi),this.bricksforgeStoreAi.showAiModal=!0}));e.prepend(t)}}createButton(e,t="block",r={},i={},s=null){const o=document.createElement("button"),c=document.createElement("div");if("block"===t)c.classList.add("bricksforge-button-wrapper"),o.classList.add("button"),o.classList.add("block"),o.classList.add("bricksforge-button"),o.classList.add("bricksforge-button-ai");if(o.innerText=e,r)for(const[e,t]of Object.entries(r))o.style[e]=t;if(i)for(const[e,t]of Object.entries(i))o.setAttribute(e,t);return s&&o.addEventListener("click",s),c.appendChild(o),c}}document.addEventListener("DOMContentLoaded",(()=>{!bricksIsFrontend&&document.querySelector("#bricks-toolbar")&&setTimeout((()=>{new BricksforgeBuilder}),1e3)}));